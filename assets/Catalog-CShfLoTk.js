import{u as R,r,j as t,X as I,L as K}from"./index-BwsMhm0T.js";import{L as W,S as q,B as h}from"./Layout-CgCQMwKM.js";import{C as D,a as F}from"./card-BO71Zjxj.js";import{l as H}from"./supabase-C5sOXNJb.js";import{l as T}from"./supabaseCards-Cl2hf8Ed.js";import{m as v}from"./proxy-CZFQajOn.js";import{S as U}from"./shopping-bag-CpgW5sND.js";import"./supabaseClient-whyNr3HJ.js";import"./tslib.es6-CmEaCU22.js";const V={hidden:{opacity:0,y:20},visible:g=>({opacity:1,y:0,transition:{delay:g*.08,duration:.5,ease:"easeOut"}})},ae=()=>{const[g,_]=R(),j=g.get("search")||"",[n,N]=r.useState("All"),[c,A]=r.useState("default"),[u,M]=r.useState([]),[x,B]=r.useState([]),[w,S]=r.useState(!0),[d,f]=r.useState(j),[m,k]=r.useState("all"),[y,C]=r.useState(""),[b,P]=r.useState("");r.useEffect(()=>{f(j)},[j]);const $=e=>!e||e.trim()===""?!1:e.startsWith("data:image/")||e.startsWith("http://")||e.startsWith("https://"),E=r.useMemo(()=>{const e=new Set;for(const a of u)a.category.split(",").map(o=>o.trim()).filter(Boolean).forEach(o=>e.add(o));for(const a of x)e.add(a.category);return["All",...Array.from(e)]},[u,x]),L=r.useMemo(()=>{const e=[];for(const a of u)e.push(a);for(const a of x)e.push({...a,images:a.images});return e},[u,x]);r.useEffect(()=>{(async()=>{S(!0);const[e,a]=await Promise.all([H(),T()]);M(e),B(a),S(!1)})()},[]);const p=r.useMemo(()=>{let e=[...L];const a=d.toLowerCase().trim();a&&(e=e.filter(s=>s.name.toLowerCase().includes(a)||(s.description||"").toLowerCase().includes(a)||s.category.toLowerCase().includes(a))),n!=="All"&&(e=e.filter(s=>s.category.split(",").map(z=>z.trim()).filter(Boolean).includes(n))),m==="in_stock"?e=e.filter(s=>s.in_stock):m==="out_of_stock"&&(e=e.filter(s=>!s.in_stock));const l=Number(y),o=Number(b);return l>0&&(e=e.filter(s=>s.price>=l)),o>0&&(e=e.filter(s=>s.price<=o)),c==="price-asc"?e.sort((s,i)=>s.price-i.price):c==="price-desc"?e.sort((s,i)=>i.price-s.price):c==="name-asc"&&e.sort((s,i)=>s.name.localeCompare(i.name)),e},[L,d,n,m,y,b,c]),O=()=>{f(""),_({})};return t.jsx(W,{children:t.jsx("section",{className:"py-16 md:py-24",children:t.jsxs("div",{className:"container",children:[t.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center",children:[t.jsx("h1",{className:"font-display text-4xl font-bold text-foreground md:text-5xl",children:"Our Catalog"}),t.jsx("p",{className:"mx-auto mt-4 max-w-lg text-muted-foreground",children:"Browse our handcrafted collection â€” each piece made with care."})]}),t.jsx("div",{className:"mx-auto mt-8 max-w-md",children:t.jsxs("div",{className:"relative",children:[t.jsx(q,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t.jsx("input",{value:d,onChange:e=>f(e.target.value),placeholder:"Search by name, description, or category...",className:"h-11 w-full rounded-full border border-border/60 bg-background pl-10 pr-10 text-sm outline-none focus:border-primary focus:ring-1 focus:ring-primary/30"}),d&&t.jsx("button",{onClick:O,className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:t.jsx(I,{className:"h-4 w-4"})})]})}),t.jsx("div",{className:"mt-6 flex flex-wrap items-center justify-center gap-3",children:E.map(e=>t.jsx(h,{variant:n===e?"default":"outline",size:"sm",className:"rounded-full",onClick:()=>N(e),children:e},e))}),t.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-center gap-3",children:[t.jsxs("select",{value:m,onChange:e=>k(e.target.value),className:"rounded-md border bg-background px-3 py-2 text-sm",children:[t.jsx("option",{value:"all",children:"All Stock"}),t.jsx("option",{value:"in_stock",children:"In Stock"}),t.jsx("option",{value:"out_of_stock",children:"Out of Stock"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"number",placeholder:"Min PKR",value:y,onChange:e=>C(e.target.value),className:"h-9 w-24 rounded-md border bg-background px-2 text-sm outline-none focus:border-primary"}),t.jsx("span",{className:"text-muted-foreground text-sm",children:"-"}),t.jsx("input",{type:"number",placeholder:"Max PKR",value:b,onChange:e=>P(e.target.value),className:"h-9 w-24 rounded-md border bg-background px-2 text-sm outline-none focus:border-primary"})]}),t.jsxs("select",{value:c,onChange:e=>A(e.target.value),className:"rounded-md border bg-background px-3 py-2 text-sm",children:[t.jsx("option",{value:"default",children:"Sort"}),t.jsx("option",{value:"price-asc",children:"Price: Low to High"}),t.jsx("option",{value:"price-desc",children:"Price: High to Low"}),t.jsx("option",{value:"name-asc",children:"Name: A-Z"})]})]}),t.jsx("div",{className:"mt-6 text-center text-sm text-muted-foreground",children:w?"Loading...":`${p.length} item${p.length!==1?"s":""} found`}),t.jsx(v.div,{initial:"hidden",animate:"visible",className:"mt-8 grid gap-6 sm:grid-cols-2 lg:grid-cols-4",children:p.map((e,a)=>t.jsx(v.div,{variants:V,custom:a,children:t.jsx(D,{className:"group h-full border-border/40 transition-all duration-300 hover:-translate-y-1 hover:shadow-lg",children:t.jsxs(F,{className:"flex h-full flex-col p-6 text-center",children:[t.jsxs("div",{className:"relative mx-auto aspect-square w-full overflow-hidden rounded-2xl border border-border/40",children:[(()=>{const l=e.images.find(o=>(o||"").trim()!=="")||"";return $(l)?t.jsx("img",{src:l,alt:e.name,className:"absolute inset-0 h-full w-full object-cover",loading:"lazy",decoding:"async"}):t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-accent text-sm text-muted-foreground",children:"No image"})})(),t.jsx("div",{className:"absolute inset-0 translate-y-full bg-pink-500/20 transition-transform duration-300 ease-out group-hover:translate-y-0"}),!e.in_stock&&t.jsx("div",{className:"absolute top-2 left-2 rounded-full bg-red-500/90 px-2.5 py-0.5 text-xs font-semibold text-white",children:"Out of Stock"}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 transition-opacity duration-200 group-hover:opacity-100",children:e.in_stock?t.jsx(h,{asChild:!0,size:"sm",className:"rounded-full",children:t.jsxs(K,{to:`/product/${e.id}`,children:[t.jsx(U,{className:"mr-2 h-4 w-4"})," View"]})}):t.jsx(h,{size:"sm",disabled:!0,className:"rounded-full",children:"Out of Stock"})})]}),t.jsxs("div",{className:"mt-4 flex items-end justify-between gap-3 text-left",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("div",{className:"font-display text-sm font-semibold text-foreground line-clamp-1",children:e.name}),t.jsx("div",{className:"mt-0.5 flex flex-wrap gap-1",children:e.category.split(",").map((l,o)=>t.jsx("span",{className:"inline-block rounded-full bg-muted px-2 py-0.5 text-xs text-muted-foreground",children:l.trim()},o))})]}),t.jsxs("div",{className:"shrink-0 text-lg font-medium text-primary",children:["PKR ",e.price]})]})]})})},e.id))},`${n}-${d}-${m}`),!w&&p.length===0&&t.jsxs("div",{className:"mt-16 text-center text-muted-foreground",children:[t.jsx("p",{className:"text-lg",children:"No products match your filters."}),t.jsx(h,{variant:"outline",className:"mt-4 rounded-full",onClick:()=>{N("All"),f(""),k("all"),C(""),P("")},children:"Clear all filters"})]})]})})})};export{ae as default};
