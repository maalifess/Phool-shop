import{s as d}from"./Layout-D0X4Id0B.js";const u=6e4;let r=null,o=null;async function f(){const a=Date.now();if(r&&a-r.ts<u)return r.data;if(o)return o;o=(async()=>{const{data:n,error:e}=await d.from("fundraisers").select("*").order("created_at",{ascending:!1});if(e)return console.error("Error loading fundraisers:",e),(r==null?void 0:r.data)??[];const t=n||[];return r={ts:Date.now(),data:t},t})();try{return await o}finally{o=null}}async function c(a){if(!Number.isFinite(a))return null;if(r){const s=r.data.find(i=>i.id===a);if(s)return s}const{data:n,error:e}=await d.from("fundraisers").select("*").eq("id",a).maybeSingle();if(e)return console.error("Error loading fundraiser:",e),null;const t=n??null;if(!t)return null;if(r){const s=r.data.findIndex(i=>i.id===a);if(s>=0){const i=[...r.data];i[s]=t,r={ts:r.ts,data:i}}}return t}async function m(a){const{data:n,error:e}=await d.from("fundraisers").insert(a).select().single();return e?(console.error("Error creating fundraiser:",e),null):(n&&r&&(r={ts:r.ts,data:[n,...r.data]}),n)}async function g(a,n){const{data:e,error:t}=await d.from("fundraisers").update(n).eq("id",a).select().single();return t?(console.error("Error updating fundraiser:",t),null):(e&&r&&(r={ts:r.ts,data:r.data.map(s=>s.id===a?e:s)}),e)}async function y(a){const{error:n}=await d.from("fundraisers").delete().eq("id",a);return n?(console.error("Error deleting fundraiser:",n),!1):(r&&(r={ts:r.ts,data:r.data.filter(e=>e.id!==a)}),!0)}export{c as a,m as c,y as d,f as l,g as u};
